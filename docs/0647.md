# Excel 中的数据验证

> 原文:[https://www.javatpoint.com/data-validation-in-excel](https://www.javatpoint.com/data-validation-in-excel)

微软 Excel 是最受欢迎的电子表格软件，具有广泛的功能，公式和功能。数据验证是微软电子表格的基本功能之一。在为用户或客户创建 Excel 工作表时，我们可能经常需要根据不同的标准来限制输入，以确保所有条目或输入都是正确和一致的。数据验证是帮助我们根据指定的规则控制用户对特定单元格或范围的输入的解决方案。

![Data validation in Excel](../Images/44e32958f646e5708d48c291744ae3f5.png)

在本文中，我们讨论了 Excel 中的数据验证功能以及在 Excel 工作表中插入/应用它的方法。文章还用图片解释了相关的例子，帮助我们清楚地理解数据验证的概念。

## 什么是数据验证？

数据验证是一项重要的 Excel 功能，有助于控制或限制选定单元格中的用户输入/条目。它使用户能够设置所需的验证规则，以控制他们可以在 Excel 工作表的相应单元格中输入什么类型的数据。例如，我们可以限制用户输入 1 到 10 之间的值，输入少于 30 个字符的名称或密码，从预定义的可接受值列表中输入或选择一个条目，等等。

我们可以使用数据验证设置的一些基本任务(限制/验证)如下:

*   允许用户仅输入**数字**或**文字**
*   允许输入小于、大于和介于指定**范围**之间的数字
*   允许特定**长度**的数据输入
*   将条目限制在**下拉列表**中的预定义值
*   将日期和时间条目限制在特定的**范围之外或之内**
*   基于另一个单元格验证特定条目
*   显示**输入信息**，告知用户选择单元格时对应单元格接受的内容
*   当用户输入错误数据时，显示**警告或错误信息**
*   在已验证的单元格中找到不正确或错误的条目

#### 注意:需要注意的是，数据验证功能并不是一种完全可靠的控制输入的方式，很容易被击败。如果我们从没有验证规则的单元格中复制数据，然后将这些单元格粘贴到有数据验证的单元格中，验证就会被破坏。具体来说，基于复制的单元格，从相应的单元格中移除或更改验证规则。

## 数据验证在 Excel 中是如何工作的？

对 Excel 工作表中的任何单元格或单元格区域应用数据验证会限制用户根据验证规则在相应的单元格中输入任何不需要的条目。例如，如果我们将验证设置为仅接受数字或数值，则其他用户或我们将无法输入除数字之外的任何值。

![Data validation in Excel](../Images/d5a63706f24f6e4a1c2d05a73197c3b1.png)

数据验证可以配置为在选择相应单元格时向用户显示输入消息，通知他们单元格中允许的内容，如下所示:

![Data validation in Excel](../Images/929c2837a3c360be53542c45b042becd.png)

只要我们尝试在受限单元格中输入任何其他类型的数据，Excel 就会立即显示错误消息，甚至可以显示各个单元格可以接受的数据类型。在 Excel 工作表中设置验证规则时，错误消息可以是不同的样式，也可以是自定义的或手动创建的。

![Data validation in Excel](../Images/ff2282d94c747bc6440d462c82cd51a8.png)

## 数据验证控制

数据验证功能或其控件可在功能区的“数据”选项卡下找到。默认情况下，它位于“数据工具”类别下。

![Data validation in Excel](../Images/1c151ce7039bbd729da394e742a3cac8.png)

我们一点击功能区的‘数据验证’图标，它就立即启动了**数据验证对话框**。

除了功能区上的数据验证快捷方式外，我们还可以使用不带引号的快捷键“ **Alt + D + L** ”。它将立即启动数据验证对话框。

## 使用数据验证对话框定义验证规则

数据验证对话框包含三个基本选项/标签:**设置、输入消息**和**错误警报**。

![Data validation in Excel](../Images/31044bf9a54e26408935bacaebb8debb.png)

让我们详细了解每个选项卡:

### 设置选项卡

“设置”选项卡为我们提供了设置验证标准的选项。该选项卡帮助我们从所选单元格中允许的内置选项中选择所需的验证规则。此外，我们还可以用定制的公式设置定制的规则来验证用户的输入。设置选项卡包含 Excel 中存在的所有**数据验证选项**。

![Data validation in Excel](../Images/23dd4402a3fd7db29f6300334d04c054.png)

### 输入消息选项卡

“输入消息”选项卡有一个文本框，一旦选择了相应的单元格，就可以输入显示的消息。输入消息是数据验证的可选功能。如果我们没有将任何消息定义为输入消息，当用户选择具有数据验证的相应单元格时，excel 不会显示任何消息。它不影响数据验证的工作，并且对用户输入到单元格中的内容没有影响或控制。但是，告知用户允许或预期的数据值可能会有所帮助。

![Data validation in Excel](../Images/75763f80260e8e1509a27fa1c98bff15.png)

### 错误警报选项卡

“错误警报”选项卡为我们提供了控制验证实施方式的选项。我们可以设置标准，然后使用任何期望的错误样式来相应地接受或拒绝用户输入。此外，我们还可以向用户显示一条消息，告知错误是什么，或者必须在相应的单元格中输入什么值。

![Data validation in Excel](../Images/b8e448bb6f3b9421930e82e91236592c.png)

目前微软 Excel 中有三种类型的错误样式，如下所示:

*   **停止**:当错误样式设置为“停止”时，Excel 会阻止用户在各自单元格中输入无效数据。如果用户输入了无效数据，它会触发一个带有指定消息的弹出窗口，并且输入会被拒绝。停止提醒窗口显示两个选项:**重试**(编辑无效数据)和**取消**(删除无效数据)。尽管“停止警报”窗口显示了重试选项，但用户必须输入正确的值，该值在重试时会通过验证。
    ![Data validation in Excel](../Images/237c20267a9ecc858495a4a781cd30f6.png)
*   **警告**:当错误样式设置为“警告”时，Excel 警告用户输入的值无效。它还显示不同的图标和指定的消息。但是，它不阻止用户输入无效值；用户可以忽略警告消息并注册一个甚至没有通过验证的值。预警窗口显示三个选项:**是**(接受无效数据)**否**(编辑无效数据)**取消**(删除无效数据)。
    ![Data validation in Excel](../Images/080a848a553f9d563528d612bb361ebc.png)
*   **信息**:当错误样式设置为“信息”时，Excel 通知用户输入的数据无效。它显示不同的图标和指定的消息。与警告错误样式一样，信息错误样式也不能防止无效数据。用户可以忽略信息消息并注册无效数据，而无需通过验证。信息提醒窗口显示两个选项:**确定**(接受无效数据)和**取消**(删除无效数据)。
    ![Data validation in Excel](../Images/a69842a5f4ad68150819c8a85079b093.png)

## 数据验证选项

从“设置”选项卡创建数据验证规则时，我们有八个选项来验证用户输入。它们如下:

![Data validation in Excel](../Images/4180e55f3bf9ec3ea490e8ad2371f34d.png)

*   **任意值**:取消限制，允许选中单元格中的每个值，不做任何验证。但是，先前使用输入消息对选定单元格进行的数据验证会在选择相应单元格时显示该消息。因此，当选择“任意值”选项时，我们必须编辑/删除输入消息。
*   **整数**:限制用户只能输入整数。一旦我们选择了“整数”选项，我们将获得更多与限制用户输入相关的选项。其他选项通常包括小于、大于、等于、介于等。例如，我们可以限制用户在受限单元格中输入 1 到 100 之间的整数。
*   **小数**:和选项‘整数’几乎一样。但是，它允许用户以十进制形式输入值。例如，如果我们限制用户输入 0 到 5 之间的十进制值，则相应的单元格可以接受 2.3、0.5、0.9、4.1 等值。
*   **列表**:是典型的验证类型。它限制用户从预定义列表中选择值。具体来说，预定义的值以下拉菜单的形式显示给用户。我们可以直接在“设置”选项卡中定义值，或者将它们作为工作表中的一个范围提供。例如，我们可以限制用户从值为“男性”、“女性”和“其他”的列表中选择性别。
*   **日期**:限制用户在日期表单中输入值。但是，我们可以设置一些验证规则，以允许以前的日期、未来的日期、特定范围之间的日期等。例如，我们可以限制单元格只接受约会行/列中的未来日期。
*   **时间**:和选项‘日期’几乎一样。但是，它限制用户输入时间。我们可以设置验证，以允许特定时间之前、之后或特定时间范围之间的时间。例如，我们可以将单元格接受时间限制在上午 8:00 到下午 7:00 之间。
*   **文本长度**:限制用户输入特定长度的值。这通常意味着根据字符或数字的数量来验证输入。例如，如果我们限制用户在所需的单元格中输入长度为 4 的值，指定的单元格只能接受四个字符或数字的值，如 JTP1、0101、ABCD 等。
*   **自定义**:是数据验证中的高级选项。此选项可用于根据自定义公式设置验证规则。具体来说，我们可以输入自定义公式来验证用户输入。公式的使用极大地扩展了数据验证规则的可能性。例如，我们可以使用自定义公式来确保输入的值是大写还是小写，检查值是否包括字符“abc”，仅允许工作日，等等。

除了验证选项之外，“设置”选项卡还显示两个复选框:

*   **忽略空白**:如果标记了该选项，则指示 Excel 不验证空/空白单元格。用技术术语来说，这个选项主要影响命令‘圈无效数据’。选中标记后，没有值的单元格即使未通过验证也不会被圈起来。
*   **将这些更改应用于所有其他具有相同设置的单元格**:如果标记了此选项，当与正在编辑的单元格/单元格的原始验证匹配时，Excel 会将应用的验证更新到所有其他单元格。

![Data validation in Excel](../Images/c9cb645af25509dee528e788766f2c60.png)

## 如何在 Excel 中添加数据验证？

要在 Excel 工作表中添加数据验证，我们必须执行以下步骤:

### 步骤 1:启动数据验证对话框

首先，我们必须选择所有要应用验证的单元格或区域。接下来，我们需要导航**数据选项卡-数据工具**组，选择**数据验证**启动数据验证对话框。

![Data validation in Excel](../Images/cfcb27548417179469f208855ee6cce7.png)

### 步骤 2:设置数据验证规则

显示数据验证对话框后，我们需要转到设置选项卡来定义验证标准。我们可以在验证条件中提供所需的值、单元格引用或公式。

假设我们需要限制用户为每个学生输入分数，但是分数必须在 0 到 100 之间。这样，我们可以在一定程度上消除错误输入的机会。为此，我们需要在“设置”选项卡中设置标准，如下图所示:

![Data validation in Excel](../Images/ddda52e11c0a96d5cc72e1d7ffb8ad5c.png)

设置完所有验证设置后，我们需要单击“确定”按钮来关闭验证对话框，或者移动到下一个选项卡来插入输入消息和/或错误警报。另外两个选项卡是可选的，用于通知用户根据验证规则输入适当的值。

### 步骤 3:创建要显示的输入消息(可选)

如果我们想向用户显示一条消息，说明所选单元格支持或允许哪种类型的数据，我们可以使用输入消息选项卡。使用输入消息，当用户选择相应的单元格时，我们可以通知用户允许的数据类型格式。

例如，我们可以在所需的字段(单元格/单元格/区域)中显示以下消息。

![Data validation in Excel](../Images/9217afa585046257f109f04130dfc18b.png)

输入信息后，我们可以单击“确定”按钮或进一步移至“错误警报”选项卡。

设置输入消息后，相应的单元格显示如下消息:

![Data validation in Excel](../Images/03053d4eba6cc37c61c704c897584be6.png)

### 步骤 4:添加错误警报(可选)

除了输入消息，我们还可以设置一个错误警报，当用户在相应的单元格中输入无效数据时显示。此外，我们还可以添加自定义错误消息。

![Data validation in Excel](../Images/c540d8844f3392749f7c50e96d6647fc.png)

在上图中，我们使用了选项“ **Stop** ”作为错误警报样式。我们可以相应地使用另外两种样式，警告和信息。最后，我们必须点击**确定**按钮。

当用户输入无效数据时，它会触发一个带有消息的错误窗口，并且不允许输入无效数据。

![Data validation in Excel](../Images/72f09404b6de9075ad64a33226d6f742.png)

如果我们没有在 Excel 单元格中设置自定义错误警报和验证规则，Excel 会自动显示带有预定义错误消息的默认错误警报。看起来是这样的:

![Data validation in Excel](../Images/db3abb7dc85c06c4b968964666c596d6.png)

## 数据验证示例

以下是 Excel 中数据验证的一些基本示例:

### 示例 1:限制用户从下拉菜单中输入/选择指定的值

假设我们希望限制用户从预定义值列表中选择一个选项/值。这种数据验证的情况用在大多数的 Excel 表格中。在我们的示例中，我们希望限制用户从预定义的值中选择性别，例如“男性”、“女性”或“其他”。

![Data validation in Excel](../Images/2be10da6eab9ae73132d17872219d98e.png)

为此，我们需要执行以下步骤:

*   首先，我们需要**选择一个单元格**来应用验证。在我们的示例中，我们选择单元格 B1。
    T3】
*   接下来，我们通过点击工具栏上**数据**选项卡下的**数据验证**图标，启动**数据验证对话框**。
    ![Data validation in Excel](../Images/50838ba807be5523faac20018a67e899.png)
*   之后，我们需要从**设置**选项卡下的下拉菜单中选择**列表**选项，并将列表项指定到以逗号分隔的源框中。但是，如果我们想要指定几个列表项，我们必须引用包含列表项的单元格区域，而不是直接在源框中输入它们。
    ![Data validation in Excel](../Images/433d8407765a4741aa8394893f772890.png)
*   最后，我们需要点击确定按钮。我们还可以从下一个选项卡指定**输入消息**，如下图所示:
    ![Data validation in Excel](../Images/54619ccbd00d70ea5b128f4505bb4cf5.png)
    除了输入消息，我们还可以从下一个选项卡指定**错误提醒消息**:
    ![Data validation in Excel](../Images/0e6333d11f00f8145eefef58934cd191.png)
    当用户点击受限单元格时，会显示下拉图标。用户可以单击图标打开列表并选择所需的选项。
    ![Data validation in Excel](../Images/d357918a7aabf1f8266fe0623bded5d1.png)
    当用户点击受限单元格时，显示输入信息:
    ![Data validation in Excel](../Images/97c31551971beff2fb5f154ccaac0d13.png)
    当用户输入自定义文本时，显示错误信息:
    ![Data validation in Excel](../Images/660a6002e78bbaa7f1bd8fa9ec017802.png)

这就是我们如何在 Excel 中使用数据验证功能并创建下拉列表。

### 示例 2:限制用户输入有效的电子邮件标识

假设我们希望在特定单元格中应用数据验证，以限制用户输入有效格式的电子邮件 id，即[【email protected】](/cdn-cgi/l/email-protection)，其中域指的是电子邮件服务提供商。

![Data validation in Excel](../Images/e7e85bc54c5eaa21b28fca85cb431a57.png)

为此，我们需要执行以下步骤:

*   首先，我们需要**选择一个特定的单元格**来应用数据验证。在我们的例子中，我们选择单元格 B1。
    T3】
*   接下来，我们需要导航到**数据**选项卡，并选择“**数据验证**选项。
    ![Data validation in Excel](../Images/1c5f3b6dc49db21ea895048f2e39e69b.png)
*   之后，我们需要从**设置**下的下拉菜单中选择**自定义**选项。我们**指定一个自定义公式** "=ISNUMBER(FIND("@ "，B1 ")"，不带外引号，只允许在选定的单元格中有符号' @ '的值。
    ![Data validation in Excel](../Images/f8a689ed879c9d7b7bbb289959709ccc.png)
*   我们可以指定**输入消息**指示用户输入有效的邮件 id，如下图:
    ![Data validation in Excel](../Images/89c3469e1f77ce7cc7b1cc389e7e78db.png)
*   最后，我们必须指定**错误警告消息**，只有当用户输入无效的电子邮件 id 时才会显示。
    T3】
*   在数据验证对话框中配置好所有选项后，我们需要点击**确定**按钮保存应用的更改。
    现在，当用户选择相应的单元格时，显示输入消息:
    ![Data validation in Excel](../Images/a05aafe826382450b8db780cd0fc5d4f.png)
    当用户输入有效的电子邮件 id 时，通过应用的验证后在单元格中被接受:
    ![Data validation in Excel](../Images/275e4aeba21d90b1ae8c3835739db5a0.png)
    当用户输入无效的电子邮件 id 时，验证失败并触发错误警报:
    ![Data validation in Excel](../Images/62fed111a82b9bae4a72f826bf455e9e.png)

这就是我们如何在 Excel 中限制特定单元格只接受有效的电子邮件 id/地址。同样，我们可以键入任何其他特定文本来相应地限制用户输入。但是，需要注意的是，FIND 函数是区分大小写的。因此，如果我们不需要限制文本的大小写，我们可以在上面的过程中使用 SEARCH 函数来代替 FIND 函数。

### 示例 3:限制用户输入未来日期

在 Excel 工作表中输入日期是常见的数据输入任务之一。有时，用户可能会输入错误的日期或未来的日期，即使我们想要在工作表中记录的所有日期都提前了。在这种情况下，我们可以使用数据验证来防止特定单元格中的未来日期。

为此，我们需要执行以下步骤:

*   首先，我们需要选择特定的单元格，然后单击工具栏中的数据验证图标。我们必须在设置选项卡下的数据验证对话框中选择一个选项**日期**。它将显示另外两个部分，如日期和结束日期。由于我们想阻止未来日期，所以我们选择选项“**小于或等于**，并将**日期公式** "=TODAY()"放在相应的部分，不加引号。
    设置完所有验证后，设置选项卡如下所示:
    ![Data validation in Excel](../Images/87a9eb1daf2fc67827e63a70fb76ae2c.png)
*   设置完验证规则后，我们可以使用接下来的两个选项卡设置输入消息和错误警报，类似于我们在上面两个示例中执行的操作。
    现在，当用户选择相应的单元格时，显示输入消息:
    ![Data validation in Excel](../Images/ce1f9f546cd6429bcdd465dc6c483b8f.png)
    当用户输入未来日期时，显示错误提示:
    ![Data validation in Excel](../Images/4b42bb1b2d940ed06d2c89a695b1df3f.png)

同样，我们可以使用 Excel 中的数据验证功能对日期进行其他限制。

### 示例 4:限制用户输入指定长度的值

有时，我们可能会希望限制用户输入任何特定长度或字符的值。假设需要接受用户输入的单元格中的 PAN 编号。由于 PAN 号是一个十位数的唯一字母数字，我们可以创建验证规则来接受长度为 10 的值。

为此，我们需要执行以下步骤:

*   首先，我们需要选择特定的单元格，然后单击工具栏中的数据验证图标。我们必须在设置选项卡下的数据验证对话框中选择一个选项**文本长度**。它将显示另外两个部分，如数据和结束长度。由于我们要允许 10 位数字，所以我们选择选项“**等于**”，并在相应的部分分别放入长度为“ **10** ”的无引号。
    设置完所有验证后，设置选项卡如下所示:
    ![Data validation in Excel](../Images/26210c015b0ff6f67fc566fb22cbf5e4.png)
*   为特定的文本长度设置验证规则后，我们可以使用接下来的两个选项卡设置输入消息和错误警报。
    现在，当用户选择相应的单元格时，显示输入消息:
    ![Data validation in Excel](../Images/f3b41d223cd674adf45a85a8a5f9c95d.png)
    当用户输入少于 10 个字符或多于 10 个字符的值时，显示错误警告消息:
    ![Data validation in Excel](../Images/68c4c447ee70d58eefaf355b9e701ffb.png)

同样，我们可以使用 Excel 中的数据验证功能为基于长度的值设置其他限制。

### 示例 5:限制用户仅以大写形式输入值

如果我们希望只接收大写的用户输入，我们可以在 Excel 中设置验证。假设我们想接受既包含文本又包含数字的 PAN 号码的输入。但是，我们只想让用户用大写。

为此，我们需要执行以下步骤:

*   首先，我们需要选择特定的单元格，然后单击工具栏中的数据验证图标。我们必须在设置选项卡下的数据验证对话框中选择选项**自定义**。接下来，我们需要应用不带引号的自定义公式“=EXACT(B1，UPPER(B1))。我们在公式中输入单元格 B1，因为 B1 是我们示例中的结果单元格。
    ![Data validation in Excel](../Images/824e96676cbc64c8f788a1829901a17d.png)
    上图中，上部函数用于匹配大写字符。此外，EXACT 函数确保单元格条目与大写版本相匹配。
*   只为大写条目设置验证规则后，我们可以使用接下来的两个选项卡设置输入消息和错误警报。
    现在，当用户选择相应的单元格时，显示输入消息:
    ![Data validation in Excel](../Images/f2b09b9b930a8eff5dbb730d1684426b.png)
    当用户输入无效值(小写值)时，显示错误提示:
    ![Data validation in Excel](../Images/a6e752d3c6b67e454e21b69f2d1db2dc.png)

同样，我们可以使用 Excel 中的“数据验证”用自定义公式设置其他限制。

## 如何在 Excel 中编辑验证规则？

假设我们之前在 Excel 工作表中应用了数据验证，现在编辑了验证规则。我们必须执行以下步骤来更改或编辑验证规则:

*   **选择有验证的单元格**。
*   从工具栏启动**数据验证对话框**。
*   **在对话框中相应的选项卡下进行所需的更改**，然后单击确定。

## 如何定位或查找数据验证？

假设我们有一个应用了数据验证规则的 Excel 工作表。现在，我们想找出有验证的细胞。我们必须执行以下步骤才能在 Excel 中查找具有数据验证的单元格:

*   导航工具栏上的**主页**选项卡。
*   点击快捷方式中的下拉图标，**找到&选择【编辑】组下的**。
*   从列表中选择“**数据验证**”选项。

![Data validation in Excel](../Images/b3f105bd44f7168411a788996fc9d714.png)

使用这些步骤后，将选择/突出显示具有验证的相应单元格。

## 如何将验证规则复制到其他单元格？

假设我们有一些带有验证规则的单元格，我们希望对其他单元格应用相同的验证规则。为此，我们可以使用粘贴特殊功能，如下所示:

*   使用快捷键 **Ctrl + C** 选择并复制有验证的单元格。
*   使用快捷方式 **Ctrl + Alt + V + N** 将复制的单元格粘贴到我们希望应用数据验证的单元格上。或者，我们可以使用右键菜单选项启动**粘贴特殊对话框**，并选择“**验证**”选项。

![Data validation in Excel](../Images/9c43e85fedee01ac094ad9525297c5bf.png)

这将对复制内容的其他单元格应用相同的验证。

## 如何删除或清除数据验证？

有两种常用方法可用于删除或清除 Excel 中的所有验证:

### 方法 1:使用数据验证对话框清除数据验证

*   **选择所有单元格**删除数据验证。
*   从功能区启动**数据验证对话框**。
*   单击设置选项卡下的选项“**清除所有**，并单击**确定**

![Data validation in Excel](../Images/86706b021889b0babfbb1f3bc30ccaac.png)

这将从选定的单元格中删除/清除数据验证。

### 方法 2:使用粘贴特殊功能清除数据验证

*   选择没有验证规则的空单元格，使用快捷键 **Ctrl +C** 复制。
*   选择要从中删除数据验证的带有验证的单元格。
*   使用 **Ctrl + V** 粘贴内容，点击**进入**

此方法通常用空单元格替换数据验证，这是在 Excel 中移除数据验证的间接方法。

* * *