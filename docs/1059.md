# VBA 阵列

> 原文:[https://www.javatpoint.com/vba-arrays](https://www.javatpoint.com/vba-arrays)

数组是一个能够存储多个值的存储单元。所有值必须是相同的数据类型。

如果要在单个变量中存储相同数据类型的列表，可以使用数组来存储。

通过使用数组，可以用相同的名称提及相关的值。你可以用下标或索引来区分它们。单个值被称为数组的元素。它们从索引 0 到最高索引值是连续的。

## 数组的类型

VBA 有两种类型的阵列，例如:

**1。静态:**静态显示器具有固定的、预先确定的可存储元素数量。您不能更改静态数组的数据类型的大小。当您与已知的实体(如性别、一周中的天数等)一起工作时，这些非常有用。

**例如:**要创建静态数组，请执行以下代码，例如:

**步骤 1:** 首先在工作表中插入一个**命令**按钮。

**第二步:**然后，你会得到一个代码窗口，并添加以下代码。

![VBA Arrays](../Images/d7d13c3b14a78e11214c6069fdb2c445.png)

**第三步:**点击**命令**按钮，会得到如下截图所示的输出。

![VBA Arrays](../Images/e8adc97e44581ef7e7b7cd1904cf2f64.png)

**2。动态:**动态数组没有固定的、预先确定的可以存储的元素数量。这些在处理无法预先确定数量的实体时非常有用。

**例如**，要创建动态数组，请执行以下步骤，例如:

**第一步:**这一次我们要从单子上读出名字，比如:> ![VBA Arrays](../Images/0b71928264b3753ca6253dc17999ecbb.png)

**第二步:**点击工作表中放置的**命令**按钮，添加以下代码行。

![VBA Arrays](../Images/b09549f2aa5e46f2c01506bda2865b04.png)

**第三步:**点击**命令**按钮，会得到如下截图所示的输出。

![VBA Arrays](../Images/9fb2429dc26b950740456d2c94529083.png)

## 雷迪姆声明

ReDim 语句用于声明动态数组变量，也用于分配或重新分配存储空间。

**ReDim 的语法**

```

ReDim [Preserve] varname (subscripts) [As type], [varname (subscripts) [As type]].

```

ReDim 语句语法有以下几个部分，例如:

| 部分 | 描述 |
| 保护 | (可选)它用于在您更改最后一个维度的大小时保留现有数组中的数据。 |
| varname | (必需)它是变量的名称。 |
| 下标 | (必需)它是数组变量的维数。它可以被声明为多达 60 个多维。下标参数使用以下语法:

```
[lowerTo] upper, [[lowerTo] upper], .......

```

当没有用 lower 显式声明时，数组的下限由 option base 语句控制。如果没有选项基语句，则下限为零。 |
| 类型 | (可选)它是变量的数据类型。可以是**字节**、**布尔**、**长**、**整数**、**单**、**双**、**货币**、**日期**、**字符串**、**对象**、**变量**，自定义或**对象**类型。 |

ReDim 语句用于调整动态数组的大小，该动态数组已经通过使用带空括号的**私有**、**公共**或 **Dim** 注释进行了声明。

您可以经常使用 ReDim 语句来更改数组中元素的数量和维度。不能声明一个数据类型的数组。

如果数组包含在一个**变体**中，那么元素的类型可以通过使用**作为**类型来改变。如果您使用的是**保留**关键字，则没有更改数据类型的权限。

## 数组维度

**1。一维:**该数组仅用于一维中的一个索引。

**比如**，每个年龄段的人很多。指定元素的唯一要求是年龄。该元素保存计数。

**dim age count(100)as guiter**

上面的示例声明了一个从 0 到 100 的一维年龄计数数组。

**2。二维:**数组使用二维中的两个索引。

**比如**，每个班几个学生。它既需要班级数量，也需要每个班级的学生数量。

**模糊学生计数(50，5)为字节**

上面的例子声明了一个二维数组，学生从 1 数到 50，班级从 1 数到 5。

**3。多维:**该数组在多数组中使用了两个以上的索引。

**例如**，白天时间(29、30、32)的温度。

**温度变暗(29，30，32)为单一**

## 阵列的优势

该阵列有一些优点，例如:

*   它将逻辑上相关的数据组合在一起。
    **例如**，如果要存储学生列表，那么可以使用单个数组变量。它为学生类别(如高中、中学、小学等)划分了位置。
*   数组使得编写合理的代码变得容易。对于相同的逻辑相关数据，它允许定义单个变量，而不是定义多个变量。
*   数组提供更好的性能。一旦定义了数组，排序、检索和修改数据就会更快。

## VBA 阵列示例

让我们从一个简单的应用程序开始。该应用程序使用数组变量中的数据占据 excel 工作表。在这个例子中，我们需要以下东西，

*   在 Microsoft Excel 中创建新工作簿，并将其保存为启用 Excel 宏的工作簿(*。xlsm)
*   在工作簿中添加命令按钮。
*   设置命令按钮的名称和标题属性。
*   然后编写填充 excel 工作表的代码。

让我们执行以下步骤，例如:

**步骤 1:** 创建新工作簿。

1.  打开微软 excel。
2.  并用保存新工作簿。xlsm 扩展。

**步骤 2:** 在表单中添加一个命令按钮。

![VBA Arrays](../Images/88223629ed264ca9a43848dcd9961011.png)

1.  将名称属性设置为 **cmdLoad 饮料**。
2.  将标题属性设置为加载饮料。
3.  现在图形用户界面如下所示。

![VBA Arrays](../Images/01b436c679f567617a3e5520a0b4dfb3.png)

**第三步:**保存 excel 文件。

1.  点击**另存为**按钮。
2.  并选择 Excel 启用宏的工作簿(*。xlsm)作为文件类型，如下截图所示。

![VBA Arrays](../Images/f5c05428d012a276fec0325fd5fd1c37.png)

**第四步:**在代码窗口写代码。

1.  点击**宏**按钮，选择“**进入**选项。
2.  然后将以下代码添加到 **cmdLoad 饮料**的点击事件中。

![VBA Arrays](../Images/319bde49716247fca22bca479abefb6d.png)

## 测试应用程序

**步骤 1:** 选择**显影剂**标签。

**第二步:**关闭**设计模式**按钮。

![VBA Arrays](../Images/fd109e5793240f640a47fd99f0d92ac2.png)

**第三步:**指示灯为，将由绿色背景变为白色背景，如下图截图所示。

![VBA Arrays](../Images/66694c903ba721804496f6377cf45353.png)

**第四步:**点击**加载饮料**按钮。

**第五步:**显示代码的输出，如下图截图所示。

![VBA Arrays](../Images/14aa56ad68cba69260568b6c47a7f7b8.png)

* * *