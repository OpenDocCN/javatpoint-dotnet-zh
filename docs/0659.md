# Excel 匹配函数

> 原文:[https://www.javatpoint.com/excel-match-function](https://www.javatpoint.com/excel-match-function)

MATCH 函数是一个内置的 Excel 函数，允许用户在行、列或表中定位查找的位置。您也可以将其理解为- MATCH 函数在一系列单元格中搜索指定的项目，并将其位置返回给用户。

**例如**一个 Excel 列包含四个值 34、12、53、29，分别为 A1:A4。要在 A1:A4 范围内找到 53 的位置，MATCH 公式将是-

=MATCH(53，A1:A4，0)

在指定范围内找到 53 后，它将返回 3，这意味着 53 是该范围内的第三项。

#### 注意:MATCH()函数支持精确匹配、近似匹配以及通配符(*、？)匹配。

MATCH()函数是查找函数的替代函数。当您需要在一个范围(范围:由用户指定)内而不是在项目本身内查找项目的位置时，请始终使用 MATCH 函数。

## 语法和参数

以下是 MATCH 函数的语法和参数值-

=MATCH(LOOKUP_value, LOOKUP_range, match_type)

“ **MATCH()函数不区分大小写，所以** Happy **和** HAPPY **对它来说都是一样的**

**LOOKUP_value(必需)**

LOOKUP_value 参数由要在 Excel 工作表的指定单元格区域中搜索的值组成。此参数是必需的参数，这意味着必须在此参数中传递该值。它可以接受数字、文本或逻辑值。

**例如**，你通过使用某人的名字作为 LOOKUP_value 来查找某人的出生日期。因此出生日期是你想要的值。

#### 注意:文本值必须用双引号("")括起来。

**LOOKUP_range(必需)**

LOOKUP_range 是一个参数，它包含将在其中搜索 LOOKUP_value 的范围。**例如**，范围将指定为 A1:A10。这是查找匹配值的范围。

**match_type(可选)**

与上述两个参数不同，它是一个可选参数，接受数值。该数字可以是 1、0 或-1，该参数的默认值是 1。

*   1 表示精确匹配或次小匹配
*   0 表示完全匹配
*   -1 表示精确匹配或次大匹配

该参数指定 [Excel](https://www.javatpoint.com/excel-tutorial) 如何在查找范围数组参数中搜索查找值的位置。

## 返回值

*   函数的作用是:如果在指定的单元格区域中找到值，则返回该值的位置。
*   如果 MATCH()函数没有找到指定的值，它将返回#N/A 错误。

## 重要提示:

以下是 MATCH()函数需要注意的一些重要提示:

*   MATCH()函数返回被搜索元素的位置。不要记住价值本身。
*   如果 MATCH()函数无法在指定范围内找到该值，它将返回#N/A 错误代码。
*   如果要搜索文本数据，请将双引号中的值作为 LOOKUP_value 传递。例如 A2:A15 范围内的“蓝牙”。
*   匹配文本值时，MATCH()函数查找精确的拼写以找到匹配项。它不区分大小写，因此无法区分大写和小写字母。
*   此函数从您在函数中提供的范围而不是从 A1 单元格开始计算指定项目的位置。因此，如果你改变范围，返回位置也会改变。
*   如果**查找值**是文本字符串，并且您也使用第三个参数**匹配类型**值为 0。您也可以在其中使用通配符。
    *   ？(问号)匹配文本字符串中的任何单个字符。
    *   *(星号)匹配文本字符串中的字符模式或序列。
    *   ~(颚化符运算符)是一种特殊的运算符，它位于字符之前，用于查找实际的问号(？)或星号(*)字符。

现在，让我们看看这个函数的不同例子，以便更好地理解它。

### MATCH()函数在 Excel 中是如何使用的？

为了理解 MATCH()函数的工作原理，以及它在不同参数值下的不同工作方式，我们有下面讨论的几个例子。

当我们在 Excel 中有太大的数据集，并且想在其中找到一些东西时，这是很有帮助的。您可以通过使用 MATCH()函数中的特定单词来查找位置。如果该值存在于该 Excel 工作表中，MATCH()将返回它的位置。

然后，你可以直接去找它，看看完整的信息。它节省了用户搜索数据的时间。

#### 注意:请记住-此函数从您在函数中定义的范围开始计算指定项目的位置，而不是从 A1 单元格开始。因此，如果你改变范围，它返回的位置也会改变。

## 精确匹配示例

首先，我们将讨论两个字符串数据精确匹配的例子。请参见以下示例:

### 示例 1:查找字符串数据

假设我们有下面给出的这组产品数据，我们将在其中寻找 Boat 耳机的位置。

![Excel match function](../Images/7c49aa6cd94b07da8eeff2a13efbb212.png)

请参见以下步骤如何实现:

**第一步:**选择一个单元格存储返回的结果，并在公式栏中写下以下公式。

=MATCH(“船耳机”，A2:A20，0)

这里**船形耳机**是要在 **A2 到 A20** 范围内搜索的查找 _ 值， **0** 用于精确匹配。

![Excel match function](../Images/907477683874c83bc83d65af7d701dae.png)

**第二步:**按回车键，搜索到的关键词如果存在，会返回一个位置。

**查找值时的结果**

**第三步:**在 Excel 文件中找到**船形耳机**后，查看 MATCH()函数返回的位置。

![Excel match function](../Images/5981a7a30604df0104d6619e8bb060ba.png)

**未找到 LOOKUP_value 时的结果**

现在，我们将寻找一个在 Excel 工作表中不可用的值。例如，A1 到 A10 范围内的手机。

![Excel match function](../Images/9fd42477b444c90ea5bc1c4324d13f15.png)

**第四步:**如果在目标单元格范围内找不到 LOOKUP_value，则不返回任何位置。它将在单元格中返回#N/A 错误，如下图所示。

![Excel match function](../Images/e1a8d10b13b38e0f9eafd1ee4637d2a2.png)

### 示例 2:查找行星的位置

让我们看一个搜索行星位置的简单例子。我们有一个行星列表，您可以使用 MATCH()函数在其中找到特定行星的位置。

我们需要找到一个精确的匹配，而不是一个近似值。因此，我们将使用 0 作为精确匹配的第三个参数值。

![Excel match function](../Images/bae5b8a522ab27ff40cba3452a198c09.png)

**第二步:**在你的 Excel 公式栏中复制粘贴下面的 MATCH()公式。

=MATCH(“土星”，A25:A35，0)

这里**土星**是要在 **A25 到 A35** 范围内搜索的查找 _ 值， **0** 用于精确匹配。

![Excel match function](../Images/a1dd0a262da59d3b62b8a69e88fa930d.png)

**第三步:**现在，点击键盘上的**回车**键，找到与土星的精确匹配后，看到 MATCH()函数返回的位置。

![Excel match function](../Images/af61149baabf8c1672dd70d29b0868a3.png)

返回值为 **6** ，表示土星是列表中的第六颗行星。

### 近似匹配

现在，使用下面的例子，我们将寻找精确或近似的匹配。因此，您将看到 MATCH()函数如何通过近似匹配来查找位置。

有两种方式:一种是次小匹配，另一种是次大匹配。描述这两种方法的一个例子。

### 示例 1:下一个最小匹配

现在，我们将通过在 match()函数的第三个参数中使用 1(用于下一个最小匹配)来展示近似匹配的示例。在本例中，我们将采用数值数据集。

我们在 Excel 工作表中有这组数字数据。

![Excel match function](../Images/0ceb4097499c451d1daa8ab7f9ec4de4.png)

我们将使用 MATCH()函数从数据列中查找精确值和近似值。请遵循以下步骤:

**第 1 步:**我们在以下可用数据中寻找 4349 或近似值。

![Excel match function](../Images/92e5523835d2f8386f9ae978697d028c.png)

**第二步:**在公式栏中使用 Excel 工作表上的以下公式，点击**进入**键得到结果。

=MATCH(4349，B38:B50，1)

![Excel match function](../Images/84a9272c11f0b789e3dce9fc677e328d.png)

**步骤 3:** 请注意，MATCH()函数返回 4 作为指定范围内的位置。值 4349 不在指定的范围内；离 4000 最近。因此，它返回了近似值位置，即 4。

![Excel match function](../Images/861c979db82b52d79bf3da0748f04166.png)

这是找到精确的或次大的近似值的位置的例子。

### 示例 2:第二大匹配

现在，我们将通过在 match()函数的第三个参数中提供-1(用于下一个最大匹配)来展示近似匹配的示例。对于本例，我们将使用上例中使用的相同数据集。

我们在 Excel 工作表中有这组数字数据。

![Excel match function](../Images/f108e406e7383a72d682438c0cf21706.png)

我们将使用 MATCH()函数从数据列中查找精确的以及下一个最大的近似值。请遵循以下步骤:

**步骤 1:** 我们正在寻找相同的值 4349，并在以下可用数据中找到它的精确或近似匹配。

![Excel match function](../Images/7ab31153f5b2800142ce8b801ede0ec6.png)

**第二步:**在公式栏中使用 Excel 工作表上的以下公式，点击**进入**键得到结果。

=MATCH(4349，B38:B50，-1)

![Excel match function](../Images/6b423fccd5a15313dfa674bc03b08a56.png)

**步骤 3:** 请注意，MATCH()函数返回 5 作为指定范围内的位置。值 4349 不在指定的范围内；它是仅次于 5000 的第二大。因此，它返回了近似值位置，即 5。

![Excel match function](../Images/8f4126073227742e446e736a9723c337.png)

这是找到精确的或次大的近似值的位置的例子。

### 示例 3:通配符匹配

Excel 允许用户使用 match()函数对数据执行通配符匹配。您可以在 Excel 中执行两个通配符操作:一个使用星号(*)和问号(？)运算符。我们将借助 MATCH()函数展示通配符匹配的例子。

我们在 Excel 工作表中有这组数据，我们将在该工作表中对数据执行通配符匹配。

![Excel match function](../Images/b5a3f5c169dc4aabf96303d3694664c0.png)

**使用问号(？)操作员**

我们将使用问号(？)符号，文本字符串在 MATCH()函数中。**比如**，Spe？？呃。MATCH()函数将查找包含类似单词的文本，如 Speaker。

**第一步:**选择一个单元格存储结果，并写出下面的 MATCH()公式。它会寻找有 P 的匹配？产品列中的 ndrive。

=MATCH("P？ndrive "，A1:A15，0)

![Excel match function](../Images/021eae61a13de1c70cf532e5b7c55df3.png)

它将返回在“产品”列中找到的第一个匹配的位置。还记得那个问号(？)将忽略指定文本的第二个字母。

**第二步:**拿到第一个匹配时已经回到位置 3。

![Excel match function](../Images/d1e5ef442a55235be6f91ca649c9a2a2.png)

**使用星号(*)运算符**

我们将在 MATCH()函数中使用星号(*)符号和文本字符串来寻找模式。例如，Sp*。MATCH()函数查找开头包含 **Sp** 的文本。

**第一步:**选择一个单元格存储结果，并写出下面的 MATCH()公式。它将查找产品名称开头有 **Sp** 的匹配项。

=MATCH("Sp* "，A1:A15，0)

![Excel match function](../Images/7dd8fae1248e2075c96be118b994df99.png)

它将返回产品列中第一个匹配模式的位置。请记住，星号(*)运算符指向文本字符串中指定的模式。

**第二步:**找到第一个匹配时已经回到位置 7。

![Excel match function](../Images/9285a50387c8857d9f12193018bef8ab.png)

### 如果数据不匹配怎么办

当 MATCH()函数找不到指定的值时，Excel 会生成一个错误(#N/A)。该#不适用错误是指**值不可用错误**。对于以下 MATCH()操作，请参见下面的屏幕截图，了解不可用的值。

在给定的数据集中，我们正在 B38 到 B50 范围内搜索值 4349。让我们看看 MATCH()函数对于#N/A 结果是什么。

![Excel match function](../Images/e18663ff1ab199af7bcdfc6d4ac26dfe.png)

请注意，在指定范围内找不到 4349 值。因此，返回了#不适用错误，即值不可用错误。

* * *